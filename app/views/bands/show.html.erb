<h1> <%= @band.name %> </h1>

<%= image_tag @band.image.url(:medium), class: "header-image" %>

<% if current_user.is_band_admin?(@band) %>
	<%= link_to 'Edit Band', edit_band_url(@band)%> |
	<%= link_to 'Delete Band', band_url(@band), method: :delete %> 
<% end %>

<h3> Members </h3>
<ul id="members-list">
<% @band.band_memberships.each do |membership| %>
  
  <% if !current_user.is_in_band?(@band) && !current_user.has_requested_membership?(@band) %>
	  <li class="member-list-item">
		 <%= button_to "Request Band Membership", band_member_requests_url(@band) %> 
	  </li>
  <% end %>
  
  <li class="member-list-item">
	  <a href="<%= user_url(membership.member) %>">
	  <%= image_tag membership.member.image.url(:thumb), class: "small-image" %>
	  <%= membership.member.email %> 
	  
	  <% if membership.role %>
		  - <%= membership.role %>
	  <% end %>
	  
	  <% if current_user.is_in_band?(@band) %>
		  <%= membership.member.is_band_admin?(@band) ? "(Admin)" : "" %>
	  <% end %>
	  </a>
	  
	  <% if current_user.is_band_admin?(@band) && !membership.member.is_band_admin?(@band) %>
		  <%= button_to "Make Admin", make_admin_url(membership), method: :put %>
	  <% end %>
  </li>
<% end %>
</ul>

<% if current_user.is_band_admin?(@band) %>
	<a href="<%= new_band_tour_url(@band) %>">
		<div class="add-box">
			<h2> + Create a Tour </h2>
		</div>
	</a>
<% end %>

<% if @band.tours.count > 0 %>
	<h2> Tours (<%= @band.tours.count %>) </h2>
	<%= render 'tours/list', tours: @tours %>
<% end %>

<h2> Events (<%= @band.events.count %>) </h2>

<% if current_user.is_band_admin?(@band) %>
	<a href="<%= new_band_event_url(@band) %>">
		<div class="add-box">
			<h2> + Add Show </h2>
		</div>
	</a>
<% end %>

<%= render 'events/list', events: @events, hide_band_name: true %>